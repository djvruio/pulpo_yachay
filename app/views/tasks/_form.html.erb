
<%= form_for([@project, @task]) do |f| %>

  <%= render "shared/errors", object: @task %>

  <div class="panel-body">
    <div class="panel panel-default">
      <div class="panel-body">
        
        <div class="field">
          <%= f.label :description %><br>
          <%= f.text_area :description, class: 'form-control' %>
        </div>
        <div class="field">        
          <table>
            <td width="220">
              
                <%= f.label :deadline %><br>
                <%= f.date_select :deadline %>
              
            </td>
            <td width="100">
              <center>
                <%= f.label :complexity %><br>
                <%= f.select :complexity, Task.complexities.keys.map {|complexity| [complexity.titleize, complexity]}%>
              </center>
            </td>

            <% if current_user.admin? %>

              <td width="150">
                <center>
                  <%= f.label :status %><br>
                  <%= f.select :status, Task.statuses.keys.map {|status| [status.titleize, status]}%>
                </center>
              </td>
              <td width="100">
                <center>
                  <%= f.label :score %><br>
                  <%= f.select :score, Task.scores.keys.map {|score| [score.titleize, score]}%>
                </center>
              </td>

              <td width="100">
                  <center>
                    <%= f.label "Assigned to" %><br>
                    <%= collection_select(:task, :assigned_to_id, User.all, :id, :email) %>
                  </center>
              </td>


            <% else %>
              <% if is_new_task(params[:action]) %>

                <td width="150">
                  <center>
                    <%= f.label :status %><br>
                    <%= f.select :status, Task.statuses.keys.map {|status| [status.titleize, status]}, {}, {:disabled=>true} %>
                  </center>
                </td>

                    <td width="100">
                      <center>
                        <%= f.label "Assigned to" %><br>
                        <%= collection_select(:task, :assigned_to_id, User.all, :id, :email) %>
                      </center>
                    </td>

              <% else %>

                <td width="150">
                  <center>
                    <%= f.label :status %><br>
                    <%= f.select :status, Task.statuses.keys.map {|status| [status.titleize, status]}%>
                  </center>
                </td>

              <% end %>
            <% end %>

          </table>
        </div>

        <div class="field">
          <%= f.hidden_field :project_id %>
        </div>
      </div>
    </div>

    
    <div class="actions">
<!--      <%= f.submit class: 'btn btn-primary' %> -->
<!--
      <%= button_tag(type: 'submit', class: "btn btn-primary btn-xs") do %>
        <%  if params[:action] == 'new' %>
          Create Task
        <% else %>
          Update Task
        <% end %>
      <% end %>    
      <%= link_to :back, :class => 'btn btn-primary btn-xs' do %>Cancel<% end %>    
-->             

    <%= button_tag(type: 'submit', class: "btn btn-default btn-sm") do %>
        <%  if params[:action] == 'new' %>
          Create Task
        <% else %>
          Update Task
        <% end %>
      <% end %>    
      <%= link_to :back, :class => 'btn btn-default btn-sm' do %>Cancel<% end %>   
    </div> 
  </div>     
<% end %>
